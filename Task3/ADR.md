### <a name="_b7urdng99y53"></a>**Название задачи:** Открытие депозитов онлайн
### <a name="_hjk0fkfyohdk"></a>**Автор:** Миннахметов Айрат
### <a name="_uanumrh8zrui"></a>**Дата:** 07.09.2025
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

| **№** | **Действующие лица или системы**         | **Use Case**                           | **Описание**                                                                                                 |
|:-----:|:-----------------------------------------|:---------------------------------------|:-------------------------------------------------------------------------------------------------------------|
|  F1   | Новый клиент, Сайт                       | Просмотр каталога депозитов            | Новый клиент видит список доступных депозитов с актуальными ставками на сайте                                |
|  F2   | Новый клиент, Сайт, Кол-центр            | Подача заявки на депозит               | Новый клиент подает заявку на депозит, оставив номер телефона и ФИО на сайте                                 |
|  F3   | Менеджер кол-центра, Система кол-центра  | Обработка заявки                       | Менеджер кол-центра может смотреть заявки на депозиты и предлагать особые условия                            |
|  F4   | Зарегистрированный клиент, Интернет-банк | Просмотр персонализированного каталога | В интернет-банке клиент видит список доступных депозитов с актуальными ставками и персонализированные ставки |
|  F5   | Зарегистрированный клиент, Интернет-банк | Создание заявки на депозит             | В интернет-банке клиент может подать заявку на открытие депозита, указав счет и сумму депозита               |
|  F6   | Клиент, Интернет-банк, СМС-шлюз          | Подтверждение операции                 | Операцию открытия депозита нужно подтвердить с помощью СМС-кода                                              |
|  F7   | Сотрудник бэк-офиса, АБС                 | Согласование ставки                    | Сотрудник бэк-офиса может согласовать ставку заявки в АБС                                                    |
|  F8   | АБС, Клиент, СМС-шлюз                    | Уведомление о статусе                  | После подтверждения сотрудником бэк-офиса ставки по депозиту, клиент получает СМС-уведомления                |
|  F9   | Сотрудники бэк-офиса, АБС                | Управление ставками                    | Сотрудники бэк-офиса кредитов и депозитов могут работать со ставками депозитов в АБС                         |
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

| **№** | **Требование**                                                                                               |
|:-----:|:-------------------------------------------------------------------------------------------------------------|
|  U1   | Интерфейс работы должен быть максимально удобным для клиента                                                 |
|  U2   | Отклик по всем операциям должен быть минимальным и занимать миллисекунды                                     |
|  U3   | Интерфейс должен соответствовать системе дизайна принятой в компании                                         |
|  R1   | Все сервисы должны работать 24/7 и быть доступны в 99,9% случаев                                             |
|  R2   | В случае сбоев в ЦОД необходимо, чтобы сервисы интернет-банка были доступны и выдерживали требуемую нагрузку |
|  P1   | Не должны быть увеличена нагрузка на БД АБС                                                                  |
|  P2   | Все сервисы банка должны выдерживать нагрузку при увеличении количества клиентов                             |
|  S1   | Поддержка системы должна проводиться командой разработки банка                                               |
|  S2   | Изменения в системе должны документироваться                                                                 |
|  +R1  | Передаваемые с сайта и интернет-банка данные должны быть зашифрованы                                         |
|  +R2  | Доработки в отправке СМС должны быть реализованы силами команды разработки банка                             |
|  +R3  | При доработках во всех системах нужно как можно больше использовать технологии, которые уже есть в банке     |
|  +R4  | Если нужны очереди сообщений, то лучше использовать Kafka на перспективу                                     |
### <a name="_qmphm5d6rvi3"></a>**Решение**

#### Диаграмма контекста C4

![Контекстная диаграмма](context.puml)

#### Диаграмма контейнеров C4

![Диаграмма контейнеров](container.puml)

#### Описание архитектурного решения

**Основные компоненты:**
- **Сайт банка** (React.js, PHP) - просмотр депозитов и подача заявок новыми клиентами
- **Интернет-банк** (ASP.NET MVC 4.5, MS SQL Server) - персонализированный каталог и создание заявок
- **Промежуточный слой** - микросервисы для изоляции АБС
- **Кол-центр** (React.js, Java Spring Boot, PostgreSQL) - обработка заявок от сайта
- **АБС** (Delphi, Oracle) - центральная система для согласования ставок и открытия депозитов
- **СМС-шлюз** - отправка SMS уведомлений
- **Телеком-оператор** (внешняя система) - доставка SMS сообщений

**Промежуточный слой включает:**
- **Сервис ставок** (Java Spring Boot) - управление ставками + кэширование в Redis
- **Сервис заявок** (Java Spring Boot) - обработка заявок на депозиты
- **Сервис уведомлений** (Java Spring Boot) - отправка SMS
- **Redis** - кэширование справочных данных и ставок

**Ключевые принципы:**
- Избегание прямой интеграции интернет-банка с АБС для снижения нагрузки
- Использование существующих технологий (ASP.NET, Java Spring Boot, MS SQL, Oracle)
- Кэширование справочных данных в Redis
- Шифрование данных (HTTPS, TLS)
### <a name="_bjrr7veeh80c"></a>**Альтернативы**

| **№** | **Альтернатива**                             | **Преимущества**                                   | **Недостатки**                                                   | **Причина отказа**                                             |
|:-----:|:---------------------------------------------|:---------------------------------------------------|:-----------------------------------------------------------------|:---------------------------------------------------------------|
|   1   | Прямая интеграция интернет-банка с АБС       | Упрощение архитектуры, снижение времени разработки | Высокая нагрузка на АБС, ограниченная масштабируемость           | Не соответствует требованиям производительности и надежности   |
|   2   | Отсутствие промежуточного слоя               | Упрощение разработки, снижение затрат              | Высокий риск перегрузки АБС, нарушение изоляции                  | Неприемлемо для критически важной системы                      |
|   3   | Монолитная архитектура для всех сервисов     | Упрощение разработки, меньше накладных расходов    | Сложность масштабирования, высокий риск возникновения узких мест | Не соответствует требованиям масштабируемости                  |
|   4   | Использование только существующих технологий | Минимизация рисков, использование экспертизы       | Ограниченная гибкость, устаревшие технологии                     | Частично принято - используется существующий стек где возможно |
|   5   | Реализация ставок в отдельной MySQL-БД       | Современные технологии, гибкость                   | Ввод нового стека, отсутствие экспертизы, дублирование данных    | MS SQL минимизирует затраты и риски                            |

**Недостатки, ограничения, риски**

**1. Сложность архитектуры:**
- Увеличивает время разработки и требует дополнительных ресурсов для поддержки
- Дополнительные точки отказа в системе

**2. Ограничения масштабирования:**
- Интернет-банк остается монолитом, что ограничивает возможности масштабирования
- АБС масштабируется только вертикально из-за архитектуры Oracle

**3. Технологические ограничения:**
- Использование устаревших технологий (ASP.NET MVC 4.5, .NET Framework 4.5)
- Сложность интеграции между различными технологическими стеками

**4. Операционные риски:**
- Увеличение сложности мониторинга и диагностики проблем
- Необходимость обучения команды новым технологиям

